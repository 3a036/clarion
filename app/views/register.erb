<style type="text/css">
  #procession > div {
    display: none;
  }
  #procession.procession_init > div.procession_init {
    display: block;
  }
  #procession.procession_unsupported > div.procession_unsupported {
    display: block;
  }
  #procession.procession_wait > div.procession_wait {
    display: block;
  }
  #procession.procession_edit > div.procession_edit {
    display: block;
  }
  #procession.procession_contact > div.procession_contact {
    display: block;
  }
  #procession.procession_ok > div.procession_ok {
    display: block;
  }
  #procession.procession_error > div.procession_error {
    display: block;
  }
</style>

<p><strong>U2F key registration<%- if @name -%> for <%= @name %><%- end -%></strong></p>
<div id="procession" class="procession_init" data-app-id="<%= @app_id %>" data-requests='<%= @requests.to_json %>' data-state='<%= @state %>' data-callback='<%= @callback %>' data-reg-id='<%= @reg_id %>'>
  <form id="callback_form" class="hidden" method='POST'>
    <input type="hidden" name="state" value="<%= @state %>">
    <input type="hidden" name="data" value="">
  </form>
  <div class="procession_init">
    <p>Loading...</p>
  </div>
  <div class="procession_unsupported">
    <p>You have to use browser supporting FIDO U2F</p>
  </div>
  <div class="procession_wait">
    <p>Insert and tap your security key.</p>
  </div>
  <div class="procession_edit">
    <p>Security key recognized:</p>
    <form id="key_name_form">
      <p><input type="text" id="key_name" placeholder="Name your key" required></p>
      <p><input type="submit" value="Save"></p>
    </form>
  </div>
  <div class="procession_contact">
    <p>Contacting...</p>
  </div>
  <div class="procession_ok">
    <p>OK...</p>
  </div>
  <div class="procession_error">
    <p>Error: try again from the previous page?</p>
  </div>
</div>
<%- if @comment -%>
<p><small><%= @comment %></small></p>
<%- end -%>


<script src="/register.js"></script>
